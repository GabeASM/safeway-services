version: '3'

services:
  gateway:
    build:
      context: .
      dockerfile: dockerfile-gateway
    container_name: gateway
    ports:
      - "8080:8080"
    networks:
      - safeway-test

  monitor:
    build:
      context: .
      dockerfile: dockerfile-monitor
    container_name: monitor
    ports:
      - "8081:8081"
    networks:
      - safeway-test

  eventos:
    build:
      context: .
      dockerfile: dockerfile-events
    container_name: eventos
    networks:
      - safeway-test

  usuarios:
    build: 
      context: .
      dockerfile: dockerfile-users
    container_name: usuarios
    networks:
      - safeway-test

  notificaciones:
    build: 
      context: .
      dockerfile: dockerfile-notification
    container_name: notificaciones
    networks:
      - safeway-test

  postgresql14-eventos:
    image: postgres:14
    container_name: postgres14-safeway-eventos
    ports:
      - "5432:5432"
    environment:
      POSTGRES_USER: 'postgres'
      POSTGRES_PASSWORD: 'postgres-eventos-atenea'
      POSTGRES_DB: 'safeway_events'
    networks:
      - safeway-test

  postgresql14-usuarios:
    image: postgres:14
    container_name: postgres14-safeway-usuarios
    ports:
      - "5433:5432"
    environment:
      POSTGRES_USER: 'postgres'
      POSTGRES_PASSWORD: 'postgres-usuarios-ares'
      POSTGRES_DB: 'safeway_users'
    networks:
      - safeway-test

  postgresql14-notificaciones:
    image: postgres:14
    container_name: postgres14-safeway-notificaciones
    ports:
      - "5434:5432"
    environment:
      POSTGRES_USER: 'postgres'
      POSTGRES_PASSWORD: 'postgres-notificaciones-poseidon'
      POSTGRES_DB: 'safeway_noti'
    networks:
      - safeway-test

  minio:
    image: minio/minio
    container_name: minio-safeway
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      MINIO_ROOT_USER: admin
      MINIO_ROOT_PASSWORD: password123
    volumes:
      - ${MINIO_DATA_PATH}:/data
      - ${MINIO_CONFIG_PATH}:/root/.minio
    command: server /data --console-address ":9001"
    networks:
      - safeway-test

networks:
  safeway-test:
    driver: bridge
